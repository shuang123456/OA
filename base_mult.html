<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>    
	<title>武汉睿创智能家居云平台系统</title>	
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta http-equiv="description" content="武汉睿创天地科技有限公司版权所有"/>
	<meta http-equiv="pragma" content="no-cache"/>
	<meta http-equiv="cache-control" content="no-cache"/>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta content="charset=UTF-8 " />
	<meta http-equiv="expires" content="0"/>    
	<meta http-equiv="keywords" content="keyword1,keyword2,keyword3"/>
	<link rel="shortcut icon" href="../css/images/logo.png" />
	<link rel="stylesheet" type="text/css" href="css/default.css"/>
	<link rel="stylesheet" type="text/css" href="css/easyui.css"/>
	<link rel="stylesheet" type="text/css" href="css/icon.css"/>
	<link rel="stylesheet" type="text/css" href="css/style.css"/>
	<script type="text/javascript" src="js/jquery.min.js" charset="UTF-8"></script>
	<script type="text/javascript" src="js/jquery.easyui.min.js" charset="UTF-8"></script>
	<script type="text/javascript" src="js/easyui-lang-zh_CN.js" charset="UTF-8"></script>
	<script type="text/javascript" src="js/ATPublic.js" charset="UTF-8"></script>
	<script type="text/javascript" src="./js/ATMask.js" charset="UTF-8"></script>
	<script type="text/javascript" src="./js/json2.js" charset="UTF-8"></script>	
	<script type="text/javascript" src="js/ATFrameWork.js"></script>

	<script>
		var params=(function(){
			var search=location.search;	//获取location的search属性，保存在search中
			var params={};		//创建空对象params
			if(search!=""){		//如果search不是空字符串
					search.slice(1).split("&").forEach(	//?module=BASEINFO&fun=ORGAN&funname=组织机构管理&is_report=&print= 1000 //search去开头?，按&切割为数组，forEach
						function(val){
						  var arr=val.split("=");		//将当前元素值按=切割，保存在arr中
							params[arr[0]]=arr[1];		//向params中添加一个元素,属性名为arr[0],值为arr[1]
						}
					);
			 }
			  return params;		//返回params
		})();
		console.log(params); 
	</script>	
			
	<script type="text/javascript">
		//如果SESSION失效，则证明登录账号失效，需要重新登录
		window.sessionStr = "";
		
		//当前页显示的主表数据
		window.data = null;
		//上一次分页显示第几页数
		window.prior_page_num = 1;

		var localjson=localStorage.getItem("localdata");
		console.log(localjson)//打印出来的是json类型数据
		var localjsonObj=JSON.parse(localjson);//转换为json对象
		
		if (isSessionValid() != false){		
			window.dsUIAll = null;
			window.inportNewUI = null;
			window.ListDs = null;
			window.rowIndex = {"rowindex":"0"};
			window.msGirdSubHeight = 29;
			window.dtlGirdSubHeight = 78;
			
			window.moduleStr = params.module;		
			window.funStr = params.fun;
			window.funnameStr = decodeURIComponent(params.funname);
	
			window.mainwhere = "";
			window.isReport = "";
			window.PRINT = "";
			
			window.detailwhere = "";
			window.isInportData = "";
			window.isModal = {"PAGE_NO":"1"};
				
			window.roleCode =  localjsonObj.rolecode;
			window.allowEdit = null;
			window.allowConfirm = null;
			window.power = "";
			
			window.queryPanelHeight = 20;
			window.focusGrid = "";
		}
		
		// //$(function(){
		window.onload=function(){
				MultConstruct(window.moduleStr, window.funStr, window.funnameStr);
				
				$('#queryGroup').panel({
					onBeforeExpand:function(){
   						//该面板在点击折叠按钮后，执行展开动作时要做的处理（方法）
   						$('#centerPanel').layout("panel", "north").panel("resize",{height:window.queryPanelHeight});
   						$('#centerPanel').layout("resize");
   						
						   $("#mdataGrid").datagrid('resize',{height:$('#centerPanel').layout("panel", "center").height() - window.msGirdSubHeight}); 
						   
   						$("#dtldataGrid").datagrid('resize',{height:$('#operPanel').layout("panel", "south").height() - window.dtlGirdSubHeight});
    				},
					onCollapse:function(){
						//该面板在点击折叠按钮后，执行折叠动作时要做的处理（方法）
						$('#centerPanel').layout("panel", "north").panel("resize",{height:33});
						$('#centerPanel').layout("resize");
						
						$("#mdataGrid").datagrid('resize',{height:$('#centerPanel').layout("panel", "center").height() - window.msGirdSubHeight});

						$("#dtldataGrid").datagrid('resize',{height:$('#operPanel').layout("panel", "south").height() - window.dtlGirdSubHeight}); 
					}
				});
   		};
   		
   		//删除等待界面
   		$("body").children("div.datagrid-mask-msg").remove();
		$("body").children("div.datagrid-mask").remove();
		
		$(window).resize(function(){  
                $("#mdataGrid").datagrid('resize',{height:$('#centerPanel').layout("panel", "center").height() - window.msGirdSubHeight});  
                $("#dtldataGrid").datagrid('resize',{height:$('#operPanel').layout("panel", "south").height() - window.dtlGirdSubHeight});  
        }); 
        
        $('#dtldataGroup').resize(function(){
        	$("#dtldataGrid").datagrid('resize',{height:$('#operPanel').layout("panel", "south").height() - window.dtlGirdSubHeight});
		});
		
	</script>
  </head>
  
  <body style="overflow-y:hidden; fit:true; scroll:no; margin:0px;">
		<div id="operPanel" class="easyui-layout" style="width:100%; height:860px; border:0px; padding:0px;">
			<!-- 菜单区 -->	
			<div id="tool_menu" data-options="region:'north',split:true" style="padding:5px; height:35px; border:0px; overflow-x: hidden; overflow-y: hidden;">
				<!-- 在此显示按钮工具栏 -->
			</div>
			<div data-options="region:'center'" style="border:0px; padding:1px;">
				<div  id="centerPanel"  class="easyui-layout" data-options="fit:true" style="border:0px;">
					<!-- 数据查询区 -->	
					<div data-options="region:'north', split:true, border:false, collapsible:true" style="height:100px; border:1px; overflow-x: hidden; overflow-y: hidden;">
						<div id="queryGroup"  class="easyui-panel"  title="数据查询" data-options="iconCls:'icon-search',collapsible:true," style="padding:10px; height:inherit; width:100%; border:0px;">
							<!-- 在此显示查询区编辑框 -->
						</div>
					</div>
					<!-- 主表数据列表区 -->	
					<div data-options="region:'center',split:true,border:false" style="border:0px; padding:0px; overflow-x: hidden; overflow-y: hidden; ">
						<div id="mdataGroup"  class="easyui-panel"  title="主表数据列表" data-options="iconCls:'icon-master',collapsible:true" style="padding:0px; height:inherit; width:100%; border:0px;">
							<div style="width:inherit; height:1px; background:#FFFFFF;"></div>
							<table id="mdataGrid"  class="easyui-datagrid"  style="width:100%; height:1px; " data-options="
										rownumbers:true,
										singleSelect:true,
										autoRowHeight:false,
										pagination:true,
										remoteSort:false,
										multiSort:true,
										pageSize1:10">				
							</table>
						</div>		
					</div>
				</div>
			</div>
			<!-- 明细表数据列表区 -->
			<div id="dtldataPanel" data-options="region:'south',split:true" style="height:490px; border:0px; padding:1px; overflow-x: hidden; overflow-y: hidden;">		
				<div id="dtldataGroup"  class="easyui-panel"  title="明细数据列表" data-options="iconCls:'icon-detail2'" style="padding:0px; height:100%; width:100%; border:0px; overflow-x: hidden; overflow-y: hidden;">
					<div style="width:100%; height:1px; background:#FFFFFF;"></div>
					<table id="dtldataGrid"  class="easyui-datagrid"  style="width:100%; height:1px;" data-options="
								rownumbers:true,
								singleSelect:false,
								autoRowHeight:false,
								pagination:false,
								remoteSort:false,
								multiSort:true,
								pageSize1:10">				
					</table>
				</div>
			</div>
		</div>
		
		<!-- 数据编辑窗体 -->	
		<div id="editWindow" class="easyui-window" title="现场施工综合业务管理平台" data-options="modal:true,
																																  closed:true,
																																  iconCls:'icon-file', 
																																  draggable:true, 
																																  resizable:true, 
																																  shadow:true,
																																  collapsible:false,
																																  minimizable:false"
																																  style="width:800px;height:300px;padding:1px;">
			<div id="edit_operPanel" class="easyui-layout" style="width:100%; height:100%; border:0px; padding:0px;">
				<div id="edit_toolPanel" data-options="region:'north',split:false" style="height:40px; border:0px; padding:0px; overflow-x: hidden; overflow-y: hidden;">
					<div id="edit_tool_menuPanel" style="padding:3px; height:28px; border:0px;">
					</div>
					<div style="width:100%; height:1px; background:#99CCFF;"></div>
				</div>
				<div id="editPanel"  data-options="region:'center', border:false" style="border:0px; padding:5px; ">
				</div>
			</div>
		</div>
	  </body>
</html>
